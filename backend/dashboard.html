<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AgentIQ</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
/* â•â•â•â• DESIGN SYSTEM â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --bg: #f5f4f0;
  --surface: #ffffff;
  --surface2: #f9f8f4;
  --border: #e5e3db;
  --border2: #d4d1c4;
  --text: #1a1917;
  --text2: #6b6760;
  --text3: #9b9890;
  --accent: #e8531a;
  --accent-bg: #fff3ee;
  --accent-border: #f5c4ae;
  --green: #1a7a4a;
  --green-bg: #f0faf4;
  --blue: #1a4fa0;
  --blue-bg: #eff4ff;
  --yellow: #a06b00;
  --yellow-bg: #fffbeb;
  --purple: #6b3fa0;
  --purple-bg: #f5f0ff;
  --radius: 8px;
  --radius-lg: 12px;
  --shadow: 0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04);
  --shadow-md: 0 4px 12px rgba(0,0,0,0.08);
}

* { box-sizing: border-box; margin: 0; padding: 0; }
html { font-size: 14px; }
body { background: var(--bg); color: var(--text); font-family: 'DM Sans', sans-serif; min-height: 100vh; display: flex; }

/* â•â•â•â• SIDEBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.sidebar {
  width: 220px;
  background: var(--text);
  color: #e8e5dd;
  display: flex;
  flex-direction: column;
  position: fixed;
  height: 100vh;
  left: 0; top: 0;
  z-index: 100;
}

.sidebar-logo {
  padding: 20px 18px;
  border-bottom: 1px solid rgba(255,255,255,0.08);
}
.logo-mark { display: flex; align-items: center; gap: 8px; }
.logo-icon {
  width: 28px; height: 28px;
  background: var(--accent);
  border-radius: 6px;
  display: flex; align-items: center; justify-content: center;
  font-size: 14px; font-weight: 700; color: white;
}
.logo-text { font-size: 15px; font-weight: 700; letter-spacing: -0.3px; }
.logo-ver { font-size: 9px; font-family: 'IBM Plex Mono', monospace; color: rgba(255,255,255,0.35); margin-top: 2px; }

.sidebar-nav { flex: 1; padding: 12px 10px; overflow-y: auto; }
.nav-section-label {
  font-size: 9px;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  color: rgba(255,255,255,0.3);
  padding: 14px 8px 4px;
  font-family: 'IBM Plex Mono', monospace;
}
.nav-item {
  display: flex;
  align-items: center;
  gap: 9px;
  padding: 7px 8px;
  border-radius: 6px;
  cursor: pointer;
  color: rgba(255,255,255,0.55);
  font-size: 13px;
  font-weight: 500;
  transition: all 0.12s;
  border: 1px solid transparent;
}
.nav-item:hover { color: rgba(255,255,255,0.9); background: rgba(255,255,255,0.07); }
.nav-item.active { color: white; background: rgba(232,83,26,0.2); border-color: rgba(232,83,26,0.3); }
.nav-item .icon { font-size: 15px; width: 18px; text-align: center; flex-shrink: 0; }
.nav-badge {
  margin-left: auto;
  font-size: 10px;
  font-family: 'IBM Plex Mono', monospace;
  background: var(--accent);
  color: white;
  padding: 1px 5px;
  border-radius: 3px;
}

.sidebar-footer {
  padding: 14px 18px;
  border-top: 1px solid rgba(255,255,255,0.08);
}
.user-chip {
  display: flex;
  align-items: center;
  gap: 9px;
  cursor: pointer;
  padding: 6px;
  border-radius: 6px;
  transition: background 0.12s;
}
.user-chip:hover { background: rgba(255,255,255,0.07); }
.user-avatar {
  width: 28px; height: 28px;
  border-radius: 50%;
  background: var(--accent);
  display: flex; align-items: center; justify-content: center;
  font-size: 11px; font-weight: 700; color: white;
}
.user-name { font-size: 12px; font-weight: 500; color: rgba(255,255,255,0.8); }
.user-role { font-size: 10px; color: rgba(255,255,255,0.35); font-family: 'IBM Plex Mono', monospace; }

/* â•â•â•â• MAIN CONTENT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.main { margin-left: 220px; flex: 1; min-height: 100vh; }

.topbar {
  background: var(--surface);
  border-bottom: 1px solid var(--border);
  padding: 12px 28px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky; top: 0; z-index: 50;
}
.page-title-bar h1 { font-size: 16px; font-weight: 600; }
.page-title-bar p { font-size: 12px; color: var(--text3); font-family: 'IBM Plex Mono', monospace; }

.topbar-actions { display: flex; gap: 8px; align-items: center; }

.btn {
  padding: 7px 14px;
  border-radius: var(--radius);
  font-size: 13px;
  font-weight: 500;
  font-family: 'DM Sans', sans-serif;
  cursor: pointer;
  border: 1px solid transparent;
  transition: all 0.12s;
  display: inline-flex;
  align-items: center;
  gap: 6px;
}
.btn-primary { background: var(--accent); color: white; border-color: var(--accent); }
.btn-primary:hover { background: #c8441a; }
.btn-secondary { background: var(--surface); color: var(--text); border-color: var(--border2); }
.btn-secondary:hover { background: var(--surface2); }
.btn-ghost { background: transparent; color: var(--text2); border: none; }
.btn-ghost:hover { background: var(--surface2); color: var(--text); }
.btn-sm { padding: 5px 10px; font-size: 12px; }
.btn-danger { background: #fef2f2; color: #dc2626; border-color: #fecaca; }
.btn-danger:hover { background: #fee2e2; }

.content { padding: 24px 28px; }

.page { display: none; }
.page.active { display: block; }

/* â•â•â•â• CARDS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
}
.card-header {
  padding: 16px 20px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.card-title { font-size: 14px; font-weight: 600; }
.card-body { padding: 20px; }

/* â•â•â•â• STAT CARDS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 14px; margin-bottom: 24px; }
.stat-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 18px 20px;
  box-shadow: var(--shadow);
}
.stat-label { font-size: 11px; color: var(--text3); font-family: 'IBM Plex Mono', monospace; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px; }
.stat-value { font-size: 28px; font-weight: 700; line-height: 1; margin-bottom: 4px; }
.stat-delta { font-size: 11px; }
.delta-up { color: var(--green); }
.delta-down { color: var(--accent); }
.stat-accent { border-left: 3px solid var(--accent); }
.stat-green { border-left: 3px solid var(--green); }
.stat-blue { border-left: 3px solid var(--blue); }
.stat-purple { border-left: 3px solid var(--purple); }

/* â•â•â•â• TABLE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.data-table { width: 100%; border-collapse: collapse; font-size: 13px; }
.data-table th {
  text-align: left;
  padding: 10px 14px;
  font-size: 11px;
  font-weight: 600;
  color: var(--text3);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-bottom: 2px solid var(--border);
  background: var(--surface2);
  font-family: 'IBM Plex Mono', monospace;
}
.data-table td { padding: 11px 14px; border-bottom: 1px solid var(--border); vertical-align: middle; }
.data-table tr:hover td { background: var(--surface2); }
.data-table tr:last-child td { border-bottom: none; }

/* â•â•â•â• BADGES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 8px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 600;
  font-family: 'IBM Plex Mono', monospace;
  border: 1px solid;
}
.badge-new { background: var(--blue-bg); color: var(--blue); border-color: #c3d6f5; }
.badge-contacted { background: var(--yellow-bg); color: var(--yellow); border-color: #fcd34d; }
.badge-replied { background: var(--purple-bg); color: var(--purple); border-color: #c4b5fd; }
.badge-converted { background: var(--green-bg); color: var(--green); border-color: #86efac; }
.badge-dead { background: #f8f8f8; color: #999; border-color: #ddd; }
.badge-sent { background: var(--green-bg); color: var(--green); border-color: #86efac; }
.badge-failed { background: #fef2f2; color: #dc2626; border-color: #fecaca; }
.badge-draft { background: var(--surface2); color: var(--text2); border-color: var(--border2); }
.badge-running { background: var(--blue-bg); color: var(--blue); border-color: #c3d6f5; }
.badge-completed { background: var(--green-bg); color: var(--green); border-color: #86efac; }
.badge-admin { background: var(--accent-bg); color: var(--accent); border-color: var(--accent-border); }

/* â•â•â•â• PIPELINE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.pipeline-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; margin-bottom: 24px; }
.pipeline-col {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  overflow: hidden;
}
.pipeline-header {
  padding: 10px 14px;
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-bottom: 2px solid;
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-family: 'IBM Plex Mono', monospace;
}
.ph-new { border-color: var(--blue); color: var(--blue); background: var(--blue-bg); }
.ph-contacted { border-color: var(--yellow); color: var(--yellow); background: var(--yellow-bg); }
.ph-replied { border-color: var(--purple); color: var(--purple); background: var(--purple-bg); }
.ph-converted { border-color: var(--green); color: var(--green); background: var(--green-bg); }
.ph-dead { border-color: #ccc; color: #888; background: #f8f8f8; }

.pipeline-count {
  font-size: 18px;
  font-weight: 700;
  padding: 14px;
  text-align: center;
  border-bottom: 1px solid var(--border);
}
.pipeline-items { padding: 8px; }
.pipeline-item {
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 8px 10px;
  margin-bottom: 6px;
  cursor: pointer;
  transition: all 0.12s;
  font-size: 12px;
}
.pipeline-item:hover { border-color: var(--border2); box-shadow: var(--shadow); }
.pipeline-item .company { font-weight: 600; }
.pipeline-item .contact { color: var(--text3); font-size: 11px; margin-top: 2px; }

/* â•â•â•â• FORMS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.form-group { margin-bottom: 16px; }
.form-label { display: block; font-size: 12px; font-weight: 600; color: var(--text2); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.4px; }
.form-input, .form-select, .form-textarea {
  width: 100%;
  padding: 9px 12px;
  border: 1px solid var(--border2);
  border-radius: var(--radius);
  font-family: 'DM Sans', sans-serif;
  font-size: 13px;
  color: var(--text);
  background: var(--surface);
  transition: border-color 0.12s;
}
.form-input:focus, .form-select:focus, .form-textarea:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(232,83,26,0.1);
}
.form-textarea { min-height: 100px; resize: vertical; }
.form-hint { font-size: 11px; color: var(--text3); margin-top: 4px; font-family: 'IBM Plex Mono', monospace; }

/* â•â•â•â• SEARCH BAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.search-bar {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 0 14px 0 12px;
  background: var(--surface);
  border: 1px solid var(--border2);
  border-radius: var(--radius);
  transition: border-color 0.12s;
}
.search-bar:focus-within { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(232,83,26,0.1); }
.search-bar input {
  border: none; outline: none;
  font-family: 'DM Sans', sans-serif;
  font-size: 13px;
  padding: 8px 0;
  background: transparent;
  color: var(--text);
  width: 200px;
}
.search-bar .icon { color: var(--text3); font-size: 14px; }

/* â•â•â•â• FILTER ROW â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.toolbar { display: flex; align-items: center; gap: 10px; margin-bottom: 16px; flex-wrap: wrap; }
.filter-select {
  padding: 7px 10px;
  border: 1px solid var(--border2);
  border-radius: var(--radius);
  font-size: 12px;
  font-family: 'DM Sans', sans-serif;
  background: var(--surface);
  color: var(--text);
  cursor: pointer;
}

/* â•â•â•â• MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.modal-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.4);
  z-index: 500;
  align-items: center;
  justify-content: center;
}
.modal-overlay.open { display: flex; }
.modal {
  background: var(--surface);
  border-radius: var(--radius-lg);
  box-shadow: 0 20px 40px rgba(0,0,0,0.15);
  width: 540px;
  max-height: 90vh;
  overflow-y: auto;
}
.modal-header {
  padding: 18px 22px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.modal-title { font-size: 15px; font-weight: 600; }
.modal-close { font-size: 20px; cursor: pointer; color: var(--text3); line-height: 1; }
.modal-close:hover { color: var(--text); }
.modal-body { padding: 22px; }
.modal-footer { padding: 14px 22px; border-top: 1px solid var(--border); display: flex; gap: 8px; justify-content: flex-end; }

/* â•â•â•â• ALERT / TOAST â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.alert {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 12px 14px;
  border-radius: var(--radius);
  border: 1px solid;
  font-size: 13px;
  margin-bottom: 16px;
}
.alert-error { background: #fef2f2; border-color: #fecaca; color: #991b1b; }
.alert-success { background: var(--green-bg); border-color: #86efac; color: #166534; }
.alert-warning { background: var(--yellow-bg); border-color: #fcd34d; color: #92400e; }
.alert-info { background: var(--blue-bg); border-color: #93c5fd; color: #1e40af; }

.toast {
  position: fixed;
  bottom: 24px;
  right: 24px;
  padding: 12px 18px;
  border-radius: var(--radius);
  background: var(--text);
  color: white;
  font-size: 13px;
  font-weight: 500;
  box-shadow: var(--shadow-md);
  z-index: 9999;
  display: none;
  align-items: center;
  gap: 8px;
  max-width: 340px;
}
.toast.show { display: flex; animation: slideUp 0.2s ease; }
.toast-success { background: #166534; }
.toast-error   { background: #991b1b; }
@keyframes slideUp { from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:translateY(0); } }

/* â•â•â•â• PROGRESS BAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.progress-bar { height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; }
.progress-fill { height: 100%; border-radius: 3px; background: var(--accent); transition: width 0.3s; }
.progress-fill.green { background: var(--green); }

/* â•â•â•â• CODE BLOCK â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.code-snippet {
  background: var(--text);
  color: #e8e5dd;
  border-radius: var(--radius);
  padding: 12px 14px;
  font-family: 'IBM Plex Mono', monospace;
  font-size: 11.5px;
  line-height: 1.7;
  overflow-x: auto;
}
.code-snippet .c { color: #6b6760; }
.code-snippet .k { color: #c084fc; }
.code-snippet .s { color: #86efac; }
.code-snippet .v { color: #fbbf24; }
.code-snippet .err { color: #f87171; }
.code-snippet .ok  { color: #34d399; }

/* â•â•â•â• MISC UTILS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.divider { border: none; border-top: 1px solid var(--border); margin: 20px 0; }
.grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
.grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; }
.flex-between { display: flex; justify-content: space-between; align-items: center; }
.text-mono { font-family: 'IBM Plex Mono', monospace; font-size: 12px; }
.text-muted { color: var(--text3); }
.text-small { font-size: 11px; }
.mt4 { margin-top: 4px; }
.mt8 { margin-top: 8px; }
.mt16 { margin-top: 16px; }
.mt24 { margin-top: 24px; }

/* â•â•â•â• LOGIN PAGE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#login-screen {
  display: none;
  position: fixed;
  inset: 0;
  background: var(--bg);
  z-index: 9999;
  align-items: center;
  justify-content: center;
}
#login-screen.show { display: flex; }
.login-box {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 40px;
  width: 400px;
  box-shadow: var(--shadow-md);
}
.login-logo { text-align: center; margin-bottom: 28px; }
.login-logo-icon {
  width: 48px; height: 48px;
  background: var(--accent);
  border-radius: 10px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 22px;
  font-weight: 800;
  color: white;
  margin-bottom: 10px;
}
.login-logo h2 { font-size: 22px; font-weight: 700; }
.login-logo p { color: var(--text3); font-size: 13px; margin-top: 3px; }

/* â•â•â•â• CAMPAIGNS CARD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.campaign-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 16px 18px;
  margin-bottom: 12px;
  box-shadow: var(--shadow);
  cursor: pointer;
  transition: box-shadow 0.12s, border-color 0.12s;
}
.campaign-card:hover { box-shadow: var(--shadow-md); border-color: var(--border2); }
.campaign-name { font-weight: 600; font-size: 14px; margin-bottom: 4px; }
.campaign-meta { font-size: 12px; color: var(--text3); font-family: 'IBM Plex Mono', monospace; }
.campaign-stats { display: flex; gap: 20px; margin-top: 12px; }
.cstat { text-align: center; }
.cstat-value { font-size: 18px; font-weight: 700; }
.cstat-label { font-size: 10px; color: var(--text3); font-family: 'IBM Plex Mono', monospace; }
.campaign-progress-bar { margin-top: 10px; }

/* â•â•â•â• LOGS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.log-entry {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 9px 14px;
  border-bottom: 1px solid var(--border);
  font-size: 12px;
}
.log-entry:last-child { border-bottom: none; }
.log-time { color: var(--text3); font-family: 'IBM Plex Mono', monospace; white-space: nowrap; flex-shrink: 0; }
.log-level {
  font-size: 10px;
  font-weight: 700;
  padding: 1px 5px;
  border-radius: 3px;
  font-family: 'IBM Plex Mono', monospace;
  flex-shrink: 0;
}
.ll-info { background: var(--blue-bg); color: var(--blue); }
.ll-warn { background: var(--yellow-bg); color: var(--yellow); }
.ll-error { background: #fef2f2; color: #dc2626; }
.ll-success { background: var(--green-bg); color: var(--green); }
.log-msg { flex: 1; word-break: break-all; }

/* â•â•â•â• EMPTY STATE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.empty-state {
  text-align: center;
  padding: 60px 24px;
  color: var(--text3);
}
.empty-icon { font-size: 40px; margin-bottom: 12px; }
.empty-title { font-size: 15px; font-weight: 600; color: var(--text2); margin-bottom: 6px; }
.empty-sub { font-size: 13px; }

/* â•â•â•â• TWO-COLUMN LAYOUT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.two-col { display: grid; grid-template-columns: 1fr 340px; gap: 16px; }
.three-col { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; }

@media (max-width: 1200px) { .stats-grid { grid-template-columns: repeat(2, 1fr); } }
@media (max-width: 900px) { .pipeline-grid { grid-template-columns: repeat(2, 1fr); } }
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- LOGIN SCREEN -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="login-screen" class="show">
  <div class="login-box">
    <div class="login-logo">
      <div class="login-logo-icon">A</div>
      <h2>AgentIQ</h2>
      <p>AI-Powered SaaS Platform</p>
    </div>

    <div id="login-error" class="alert alert-error" style="display:none">
      <span>âš ï¸</span>
      <span id="login-error-msg">Invalid email or password</span>
    </div>

    <div class="form-group">
      <label class="form-label">Email Address</label>
      <input class="form-input" id="login-email" type="email" placeholder="you@company.com" value="admin@agentiq.app">
    </div>
    <div class="form-group" style="margin-bottom:20px">
      <label class="form-label">Password</label>
      <input class="form-input" id="login-password" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" value="password">
      <p class="form-hint">// Demo: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6a0b0e0703042a0b0d0f041e031b440b1a1a">[email&#160;protected]</a> / password</p>
    </div>

    <button class="btn btn-primary" style="width:100%" onclick="doLogin()">
      Sign In â†’
    </button>

    <p style="text-align:center;margin-top:14px;font-size:12px;color:var(--text3)">
      No account? <a href="#" style="color:var(--accent)" onclick="showToast('Register via POST /auth/register API endpoint', 'info')">Contact your admin</a>
    </p>

    <hr class="divider">
    <div class="code-snippet">
<span class="c"># API endpoint:</span>
POST /auth/register
{
  <span class="s">"email"</span>: <span class="v">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e1988e94a1828e8c91808f98cf828e8c">[email&#160;protected]</a>"</span>,
  <span class="s">"password"</span>: <span class="v">"your_password"</span>,
  <span class="s">"full_name"</span>: <span class="v">"Jane Smith"</span>,
  <span class="s">"org_name"</span>: <span class="v">"Acme Corp"</span>
}
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- APP SHELL -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<aside class="sidebar">
  <div class="sidebar-logo">
    <div class="logo-mark">
      <div class="logo-icon">A</div>
      <div>
        <div class="logo-text">AgentIQ</div>
        <div class="logo-ver">// v2.0.0 Â· FastAPI + Groq</div>
      </div>
    </div>
  </div>

  <nav class="sidebar-nav">
    <div class="nav-section-label">Main</div>
    <div class="nav-item active" onclick="showPage('dashboard', this)">
      <span class="icon">ğŸ“Š</span> Dashboard
    </div>

    <div class="nav-section-label">CRM</div>
    <div class="nav-item" onclick="showPage('leads', this)">
      <span class="icon">ğŸ‘¥</span> Leads
      <span class="nav-badge" id="badge-leads">12</span>
    </div>
    <div class="nav-item" onclick="showPage('pipeline', this)">
      <span class="icon">ğŸ”€</span> Pipeline
    </div>
    <div class="nav-item" onclick="showPage('campaigns', this)">
      <span class="icon">ğŸ“§</span> Campaigns
    </div>

    <div class="nav-section-label">AI</div>
    <div class="nav-item" onclick="showPage('enrichment', this)">
      <span class="icon">ğŸ¤–</span> Enrichment Jobs
    </div>

    <div class="nav-section-label">System</div>
    <div class="nav-item" onclick="showPage('logs', this)">
      <span class="icon">ğŸ“‹</span> Logs & Metrics
    </div>
    <div class="nav-item" onclick="showPage('settings', this)">
      <span class="icon">âš™ï¸</span> Settings
    </div>
    <div class="nav-item admin-only" onclick="showPage('admin', this)">
      <span class="icon">ğŸ”‘</span> Admin
    </div>
  </nav>

  <div class="sidebar-footer">
    <div class="user-chip" onclick="doLogout()">
      <div class="user-avatar" id="user-avatar">J</div>
      <div>
        <div class="user-name" id="user-name">Jane Smith</div>
        <div class="user-role" id="user-role">admin</div>
      </div>
    </div>
  </div>
</aside>

<div class="main">
  <!-- Topbar -->
  <div class="topbar">
    <div class="page-title-bar">
      <h1 id="topbar-title">Dashboard</h1>
      <p id="topbar-sub">// Overview & metrics</p>
    </div>
    <div class="topbar-actions">
      <div class="search-bar">
        <span class="icon">ğŸ”</span>
        <input type="text" placeholder="Search leads, campaigns...">
      </div>
      <button class="btn btn-primary btn-sm" onclick="openModal('modal-new-lead')">+ New Lead</button>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â• DASHBOARD PAGE â•â•â•â•â•â•â•â•â•â• -->
  <div class="content">

  <div class="page active" id="page-dashboard">
    <div class="stats-grid">
      <div class="stat-card stat-blue">
        <div class="stat-label">Total Leads</div>
        <div class="stat-value">1,247</div>
        <div class="stat-delta delta-up">â†‘ 18% vs last month</div>
      </div>
      <div class="stat-card stat-green">
        <div class="stat-label">Converted</div>
        <div class="stat-value">84</div>
        <div class="stat-delta delta-up">â†‘ 6.7% conversion rate</div>
      </div>
      <div class="stat-card stat-accent">
        <div class="stat-label">Emails Sent</div>
        <div class="stat-value">3,891</div>
        <div class="stat-delta delta-up">â†‘ 94% delivery rate</div>
      </div>
      <div class="stat-card stat-purple">
        <div class="stat-label">AI Credits Used</div>
        <div class="stat-value">2,104</div>
        <div class="stat-delta text-muted">of 5,000 this month</div>
      </div>
    </div>

    <div class="two-col">
      <div>
        <!-- Recent Activity -->
        <div class="card">
          <div class="card-header">
            <div class="card-title">Recent Activity</div>
            <button class="btn btn-ghost btn-sm" onclick="showPage('logs', document.querySelector('[onclick*=logs]'))">View all â†’</button>
          </div>
          <div id="activity-log">
            <div class="log-entry">
              <span class="log-time">09:41</span>
              <span class="log-level ll-success">SENT</span>
              <span class="log-msg">Campaign "Q4 Outreach" â€” 48 emails delivered</span>
            </div>
            <div class="log-entry">
              <span class="log-time">09:38</span>
              <span class="log-level ll-info">ENRICH</span>
              <span class="log-msg">AI enriched "Stripe" â€” confidence 9/10 Â· 1,240 tokens</span>
            </div>
            <div class="log-entry">
              <span class="log-time">09:22</span>
              <span class="log-level ll-warn">WARN</span>
              <span class="log-msg">Groq rate limit hit â€” retrying in 4s (attempt 1/3)</span>
            </div>
            <div class="log-entry">
              <span class="log-time">09:15</span>
              <span class="log-level ll-info">IMPORT</span>
              <span class="log-msg">CSV import: 94 created, 6 updated, 0 skipped</span>
            </div>
            <div class="log-entry">
              <span class="log-time">08:55</span>
              <span class="log-level ll-error">ERROR</span>
              <span class="log-msg">SMTP auth failed for <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="88eae7fde6ebedc8eafae7e3ede6a6ebe7e5">[email&#160;protected]</a> â€” recipient refused</span>
            </div>
            <div class="log-entry">
              <span class="log-time">08:44</span>
              <span class="log-level ll-success">LOGIN</span>
              <span class="log-msg"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f293969f9b9cb29395979c869b83dc938282">[email&#160;protected]</a> logged in from 192.168.1.1</span>
            </div>
            <div class="log-entry">
              <span class="log-time">08:30</span>
              <span class="log-level ll-info">JOB</span>
              <span class="log-msg">Batch job #a1b2c3 completed: 50 enriched, 2 failed / 52 total</span>
            </div>
          </div>
        </div>

        <!-- Pipeline Summary -->
        <div class="card mt16">
          <div class="card-header">
            <div class="card-title">Pipeline Summary</div>
            <button class="btn btn-ghost btn-sm" onclick="showPage('pipeline', document.querySelector('[onclick*=pipeline]'))">View kanban â†’</button>
          </div>
          <table class="data-table">
            <thead>
              <tr><th>Stage</th><th>Count</th><th>% of Total</th><th>Trend</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="badge badge-new">new</span></td>
                <td><strong>412</strong></td>
                <td>33%</td>
                <td><span style="color:var(--green)">â†‘ +24</span></td>
              </tr>
              <tr>
                <td><span class="badge badge-contacted">contacted</span></td>
                <td><strong>601</strong></td>
                <td>48%</td>
                <td><span style="color:var(--green)">â†‘ +12</span></td>
              </tr>
              <tr>
                <td><span class="badge badge-replied">replied</span></td>
                <td><strong>150</strong></td>
                <td>12%</td>
                <td><span style="color:var(--accent)">â†“ -3</span></td>
              </tr>
              <tr>
                <td><span class="badge badge-converted">converted</span></td>
                <td><strong>84</strong></td>
                <td>6.7%</td>
                <td><span style="color:var(--green)">â†‘ +8</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div>
        <!-- Health Check -->
        <div class="card">
          <div class="card-header">
            <div class="card-title">System Health</div>
            <button class="btn btn-ghost btn-sm" onclick="checkHealth()">Refresh</button>
          </div>
          <div class="card-body" id="health-status">
            <div class="flex-between" style="padding:8px 0;border-bottom:1px solid var(--border)">
              <span style="font-size:13px">Database (Neon)</span>
              <span class="badge badge-converted">âœ“ OK</span>
            </div>
            <div class="flex-between" style="padding:8px 0;border-bottom:1px solid var(--border)">
              <span style="font-size:13px">AI API (Groq)</span>
              <span class="badge badge-converted">âœ“ configured</span>
            </div>
            <div class="flex-between" style="padding:8px 0;border-bottom:1px solid var(--border)">
              <span style="font-size:13px">Redis / Celery</span>
              <span class="badge badge-converted">âœ“ connected</span>
            </div>
            <div class="flex-between" style="padding:8px 0;border-bottom:1px solid var(--border)">
              <span style="font-size:13px">SMTP</span>
              <span class="badge badge-converted">âœ“ configured</span>
            </div>
            <div class="flex-between" style="padding:8px 0">
              <span style="font-size:13px">Active Jobs</span>
              <span class="badge badge-new">2 running</span>
            </div>
          </div>
        </div>

        <!-- Active Campaigns -->
        <div class="card mt16">
          <div class="card-header">
            <div class="card-title">Active Campaigns</div>
          </div>
          <div class="card-body">
            <div style="margin-bottom:14px">
              <div class="flex-between" style="margin-bottom:5px">
                <span style="font-size:13px;font-weight:600">Q4 SaaS Outreach</span>
                <span class="badge badge-running">running</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill green" style="width:65%"></div>
              </div>
              <p class="text-mono text-muted mt4">195/300 sent Â· 65% done</p>
            </div>
            <div>
              <div class="flex-between" style="margin-bottom:5px">
                <span style="font-size:13px;font-weight:600">EU Expansion Wave 2</span>
                <span class="badge badge-draft">draft</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width:0%"></div>
              </div>
              <p class="text-mono text-muted mt4">0/88 sent Â· not started</p>
            </div>
          </div>
        </div>

        <!-- API Usage -->
        <div class="card mt16">
          <div class="card-header">
            <div class="card-title">AI Usage (30 days)</div>
          </div>
          <div class="card-body">
            <div class="flex-between" style="margin-bottom:8px">
              <span style="font-size:13px">Credits Used</span>
              <span style="font-size:13px;font-weight:600">2,104 / 5,000</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width:42%"></div>
            </div>
            <div class="mt8 text-mono text-muted" style="font-size:11px">
              â†‘ 1.2M tokens Â· avg 8.3/10 confidence Â· 42% quota used
            </div>
          </div>
        </div>
      </div>
    </div>
  </div><!-- /dashboard -->

  <!-- â•â•â•â•â•â•â•â•â•â• LEADS PAGE â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-leads">
    <div class="alert alert-info">
      <span>â„¹ï¸</span>
      <span>CSV import available â€” drag & drop or use the "Import CSV" button. Duplicate emails are auto-detected and updated.</span>
    </div>

    <div class="toolbar">
      <div class="search-bar">
        <span class="icon">ğŸ”</span>
        <input type="text" placeholder="Search company, email..." oninput="filterLeads(this.value)">
      </div>
      <select class="filter-select" onchange="filterLeadsByStatus(this.value)">
        <option value="">All Statuses</option>
        <option value="new">New</option>
        <option value="contacted">Contacted</option>
        <option value="replied">Replied</option>
        <option value="converted">Converted</option>
        <option value="dead">Dead</option>
      </select>
      <select class="filter-select">
        <option value="">All Sources</option>
        <option>csv_import</option>
        <option>ai_enriched</option>
        <option>manual</option>
      </select>
      <div style="margin-left:auto;display:flex;gap:8px">
        <button class="btn btn-secondary btn-sm" onclick="openModal('modal-import-csv')">ğŸ“ Import CSV</button>
        <button class="btn btn-secondary btn-sm" onclick="exportCSV()">â¬‡ Export CSV</button>
        <button class="btn btn-primary btn-sm" onclick="openModal('modal-new-lead')">+ New Lead</button>
      </div>
    </div>

    <div class="card">
      <table class="data-table" id="leads-table">
        <thead>
          <tr>
            <th><input type="checkbox" onchange="selectAll(this)"></th>
            <th>Company</th>
            <th>Contact</th>
            <th>Email</th>
            <th>Industry</th>
            <th>Status</th>
            <th>Score</th>
            <th>Source</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="leads-tbody">
          <!-- populated by JS -->
        </tbody>
      </table>
    </div>
  </div><!-- /leads -->

  <!-- â•â•â•â•â•â•â•â•â•â• PIPELINE PAGE â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-pipeline">
    <div class="toolbar">
      <p style="font-size:13px;color:var(--text3)">Drag cards to update lead status â€” or use the dropdown in each card.</p>
      <button class="btn btn-secondary btn-sm" style="margin-left:auto" onclick="openModal('modal-new-lead')">+ Add Lead</button>
    </div>

    <div class="pipeline-grid">
      <div class="pipeline-col">
        <div class="pipeline-header ph-new">
          <span>NEW</span>
          <span id="pipe-count-new">412</span>
        </div>
        <div class="pipeline-count" style="color:var(--blue)">412</div>
        <div class="pipeline-items" id="pipe-new">
          <div class="pipeline-item">
            <div class="company">Stripe</div>
            <div class="contact">Jane Smith Â· <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0c666d62694c7f787e657c69226f6361">[email&#160;protected]</a></div>
          </div>
          <div class="pipeline-item">
            <div class="company">Notion Labs</div>
            <div class="contact">Bob Lee Â· <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="cfada0ad8fa1a0bba6a0a1e1bca0">[email&#160;protected]</a></div>
          </div>
          <div class="pipeline-item">
            <div class="company">Linear</div>
            <div class="contact">Sarah K Â· <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ea998b988b82aa8683848f8b98c48b9a9a">[email&#160;protected]</a></div>
          </div>
        </div>
      </div>

      <div class="pipeline-col">
        <div class="pipeline-header ph-contacted">
          <span>CONTACTED</span>
          <span id="pipe-count-contacted">601</span>
        </div>
        <div class="pipeline-count" style="color:var(--yellow)">601</div>
        <div class="pipeline-items">
          <div class="pipeline-item">
            <div class="company">Figma</div>
            <div class="contact">Marc D Â· <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b9d4d8cbdaf9dfd0ded4d897dad6d4">[email&#160;protected]</a></div>
          </div>
          <div class="pipeline-item">
            <div class="company">Vercel</div>
            <div class="contact">Lisa T Â· <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="aac6c3d9cbeadccfd8c9cfc684c9c5c7">[email&#160;protected]</a></div>
          </div>
        </div>
      </div>

      <div class="pipeline-col">
        <div class="pipeline-header ph-replied">
          <span>REPLIED</span>
          <span>150</span>
        </div>
        <div class="pipeline-count" style="color:var(--purple)">150</div>
        <div class="pipeline-items">
          <div class="pipeline-item">
            <div class="company">PostHog</div>
            <div class="contact">Tim W Â· <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2f5b46426f5f405c5b474048014c4042">[email&#160;protected]</a></div>
          </div>
        </div>
      </div>

      <div class="pipeline-col">
        <div class="pipeline-header ph-converted">
          <span>CONVERTED</span>
          <span>84</span>
        </div>
        <div class="pipeline-count" style="color:var(--green)">84</div>
        <div class="pipeline-items">
          <div class="pipeline-item">
            <div class="company">Loom</div>
            <div class="contact">Karen N Â· <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="513a3023343f113d3e3e3c7f323e3c">[email&#160;protected]</a></div>
          </div>
        </div>
      </div>

      <div class="pipeline-col">
        <div class="pipeline-header ph-dead">
          <span>DEAD</span>
          <span>43</span>
        </div>
        <div class="pipeline-count" style="color:#888">43</div>
        <div class="pipeline-items">
          <div class="pipeline-item">
            <div class="company">OldCo Inc</div>
            <div class="contact"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="caa8a5bfa4a9af8aaeafabaee4a9a5a7">[email&#160;protected]</a></div>
          </div>
        </div>
      </div>
    </div>
  </div><!-- /pipeline -->

  <!-- â•â•â•â•â•â•â•â•â•â• CAMPAIGNS PAGE â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-campaigns">
    <div class="toolbar">
      <div class="alert alert-warning" style="flex:1;margin:0">
        <span>âš ï¸</span>
        <span>SMTP must be configured before sending. Go to <strong>Settings</strong> to verify: POST /email/test</span>
      </div>
      <button class="btn btn-primary btn-sm" onclick="openModal('modal-new-campaign')">+ New Campaign</button>
    </div>

    <div id="campaigns-list">
      <div class="campaign-card">
        <div class="flex-between">
          <div>
            <div class="campaign-name">Q4 SaaS Outreach</div>
            <div class="campaign-meta">Created 2d ago Â· 30 emails/min Â· reply-to: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c7b4a6aba2b487a6a0a2a9b3aeb6e9a6b7b7">[email&#160;protected]</a></div>
          </div>
          <span class="badge badge-running">running</span>
        </div>
        <div class="campaign-stats">
          <div class="cstat"><div class="cstat-value" style="color:var(--text)">300</div><div class="cstat-label">TOTAL</div></div>
          <div class="cstat"><div class="cstat-value" style="color:var(--green)">195</div><div class="cstat-label">SENT</div></div>
          <div class="cstat"><div class="cstat-value" style="color:var(--blue)">42</div><div class="cstat-label">OPENED</div></div>
          <div class="cstat"><div class="cstat-value" style="color:var(--purple)">11</div><div class="cstat-label">REPLIED</div></div>
          <div class="cstat"><div class="cstat-value" style="color:var(--accent)">3</div><div class="cstat-label">FAILED</div></div>
        </div>
        <div class="campaign-progress-bar">
          <div class="flex-between text-mono text-muted" style="font-size:11px;margin-bottom:4px"><span>65% sent</span><span>5 hrs remaining</span></div>
          <div class="progress-bar"><div class="progress-fill green" style="width:65%"></div></div>
        </div>
        <div style="display:flex;gap:8px;margin-top:12px">
          <button class="btn btn-secondary btn-sm" onclick="showToast('Campaign paused', 'success')">â¸ Pause</button>
          <button class="btn btn-secondary btn-sm" onclick="openModal('modal-preview-email')">ğŸ‘ Preview</button>
          <button class="btn btn-secondary btn-sm" onclick="showPage('logs', document.querySelector('[onclick*=logs]'))">ğŸ“‹ Email Logs</button>
        </div>
      </div>

      <div class="campaign-card">
        <div class="flex-between">
          <div>
            <div class="campaign-name">EU Expansion Wave 2</div>
            <div class="campaign-meta">Created 4h ago Â· 20 emails/min Â· 88 leads</div>
          </div>
          <span class="badge badge-draft">draft</span>
        </div>
        <div class="campaign-stats">
          <div class="cstat"><div class="cstat-value" style="color:var(--text)">88</div><div class="cstat-label">TOTAL</div></div>
          <div class="cstat"><div class="cstat-value" style="color:var(--green)">0</div><div class="cstat-label">SENT</div></div>
          <div class="cstat"><div class="cstat-value" style="color:var(--blue)">0</div><div class="cstat-label">OPENED</div></div>
          <div class="cstat"><div class="cstat-value" style="color:var(--purple)">0</div><div class="cstat-label">REPLIED</div></div>
          <div class="cstat"><div class="cstat-value" style="color:var(--accent)">0</div><div class="cstat-label">FAILED</div></div>
        </div>
        <div style="display:flex;gap:8px;margin-top:12px">
          <button class="btn btn-primary btn-sm" onclick="sendCampaign()">â–¶ Send Now</button>
          <button class="btn btn-secondary btn-sm" onclick="openModal('modal-preview-email')">ğŸ‘ Preview</button>
          <button class="btn btn-danger btn-sm" onclick="showToast('Campaign deleted', 'info')">ğŸ—‘</button>
        </div>
      </div>
    </div>
  </div><!-- /campaigns -->

  <!-- â•â•â•â•â•â•â•â•â•â• ENRICHMENT PAGE â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-enrichment">
    <div class="alert alert-info">
      <span>ğŸ¤–</span>
      <span>AI enrichment uses Groq (llama-3.3-70b). Free tier: ~30 req/min. Batch jobs are rate-limited automatically with 2s between companies. Each enrichment costs 1 credit.</span>
    </div>

    <div class="toolbar">
      <button class="btn btn-primary btn-sm" onclick="openModal('modal-new-job')">+ New Batch Job</button>
      <button class="btn btn-secondary btn-sm" onclick="showToast('Single enrichment: POST /enrich/single', 'info')">âš¡ Single Enrich</button>
    </div>

    <div class="card">
      <div class="card-header">
        <div class="card-title">Enrichment Jobs</div>
        <span class="text-mono text-muted">Celery workers process these in background</span>
      </div>
      <table class="data-table">
        <thead>
          <tr><th>Job Name</th><th>Status</th><th>Progress</th><th>Companies</th><th>Created</th><th>Actions</th></tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Q4 Lead Batch</strong><br><span class="text-mono text-muted">Job #a1b2c3d4</span></td>
            <td><span class="badge badge-running">running</span></td>
            <td>
              <div class="progress-bar" style="width:120px">
                <div class="progress-fill" style="width:68%"></div>
              </div>
              <span class="text-mono text-muted" style="font-size:10px">34/50 Â· 68%</span>
            </td>
            <td>50 companies</td>
            <td class="text-mono text-muted">2h ago</td>
            <td><button class="btn btn-ghost btn-sm">View Results</button></td>
          </tr>
          <tr>
            <td><strong>EU Prospects</strong><br><span class="text-mono text-muted">Job #e5f6g7h8</span></td>
            <td><span class="badge badge-completed">completed</span></td>
            <td>
              <div class="progress-bar" style="width:120px"><div class="progress-fill green" style="width:100%"></div></div>
              <span class="text-mono text-muted" style="font-size:10px">88/88 Â· 100%</span>
            </td>
            <td>88 companies</td>
            <td class="text-mono text-muted">1d ago</td>
            <td>
              <button class="btn btn-ghost btn-sm">View Results</button>
              <button class="btn btn-ghost btn-sm">â¬‡ CSV</button>
            </td>
          </tr>
          <tr>
            <td><strong>Stale Import</strong><br><span class="text-mono text-muted">Job #i9j0k1l2</span></td>
            <td><span class="badge badge-failed">failed</span></td>
            <td>
              <div class="progress-bar" style="width:120px"><div class="progress-fill" style="width:22%;background:var(--accent)"></div></div>
              <span class="text-mono" style="font-size:10px;color:var(--accent)">11/50 Â· timeout</span>
            </td>
            <td>50 companies</td>
            <td class="text-mono text-muted">3d ago</td>
            <td>
              <button class="btn btn-ghost btn-sm" onclick="showToast('Job retried â€” added to queue', 'success')">ğŸ” Retry</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div><!-- /enrichment -->

  <!-- â•â•â•â•â•â•â•â•â•â• LOGS PAGE â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-logs">
    <div class="three-col" style="margin-bottom:24px">
      <div class="stat-card">
        <div class="stat-label">Total API Calls (30d)</div>
        <div class="stat-value">8,441</div>
        <div class="stat-delta delta-up">â†‘ 1.2M tokens consumed</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Error Rate</div>
        <div class="stat-value" style="color:var(--accent)">1.2%</div>
        <div class="stat-delta text-muted">101 errors / 8,441 calls</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Avg Confidence</div>
        <div class="stat-value" style="color:var(--green)">8.3</div>
        <div class="stat-delta text-muted">out of 10 / last 30d</div>
      </div>
    </div>

    <div class="toolbar">
      <select class="filter-select" onchange="filterLogs(this.value)">
        <option value="">All Events</option>
        <option value="enrichment">AI Enrichment</option>
        <option value="email">Email Sends</option>
        <option value="error">Errors Only</option>
        <option value="auth">Auth Events</option>
      </select>
      <button class="btn btn-secondary btn-sm" style="margin-left:auto" onclick="checkHealth()">ğŸ“Š /health check</button>
    </div>

    <div class="card">
      <div class="card-header">
        <div class="card-title">System Log</div>
        <span class="text-mono text-muted">GET /logs Â· GET /email/logs</span>
      </div>
      <div id="logs-list">
        <div class="log-entry">
          <span class="log-time">2024-01-15 09:41:22</span>
          <span class="log-level ll-success">SENT</span>
          <span class="log-msg">email â†’ <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="89e3e8e7ecc9fafdfbe0f9eca7eae6e4">[email&#160;protected]</a> Â· "Q4 Outreach" Â· msg-id: &lt;abc123&gt;</span>
        </div>
        <div class="log-entry">
          <span class="log-time">2024-01-15 09:40:01</span>
          <span class="log-level ll-info">ENRICH</span>
          <span class="log-msg">Stripe | confidence=9/10 | tokens=1,240 | tools=7 | 18.4s</span>
        </div>
        <div class="log-entry">
          <span class="log-time">2024-01-15 09:38:55</span>
          <span class="log-level ll-warn">WARN</span>
          <span class="log-msg">Groq RateLimitError â€” attempt 1/3, backing off 2s | model=llama-3.3-70b</span>
        </div>
        <div class="log-entry">
          <span class="log-time">2024-01-15 09:35:12</span>
          <span class="log-level ll-error">ERROR</span>
          <span class="log-msg">SMTP SMTPRecipientsRefused â€” <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="80e2eff5eee3e5c0e2f2efebe5eeaee3efed">[email&#160;protected]</a> refused by server</span>
        </div>
        <div class="log-entry">
          <span class="log-time">2024-01-15 09:22:01</span>
          <span class="log-level ll-info">IMPORT</span>
          <span class="log-msg">CSV import complete: 94 created, 6 updated, 0 skipped, 0 errors</span>
        </div>
        <div class="log-entry">
          <span class="log-time">2024-01-15 08:55:33</span>
          <span class="log-level ll-info">AUTH</span>
          <span class="log-msg">POST /auth/login â†’ <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5b3a3f3632351b3a3c3e352f322a753a2b2b">[email&#160;protected]</a> (JWT issued, expires 24h)</span>
        </div>
        <div class="log-entry">
          <span class="log-time">2024-01-15 08:44:10</span>
          <span class="log-level ll-error">ERROR</span>
          <span class="log-msg">Job #i9j0k1l2 hit 1h soft time limit â†’ status=partial (11/50 saved)</span>
        </div>
        <div class="log-entry">
          <span class="log-time">2024-01-15 07:30:00</span>
          <span class="log-level ll-info">STARTUP</span>
          <span class="log-msg">âœ“ Config validated | env=production | warnings=0 | AgentIQ v2 started</span>
        </div>
      </div>
    </div>
  </div><!-- /logs -->

  <!-- â•â•â•â•â•â•â•â•â•â• SETTINGS PAGE â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-settings">
    <div class="two-col">
      <div>
        <!-- SMTP Config -->
        <div class="card" style="margin-bottom:16px">
          <div class="card-header"><div class="card-title">ğŸ“§ Email / SMTP Configuration</div></div>
          <div class="card-body">
            <div class="alert alert-warning">
              <span>âš ï¸</span>
              <span>These are read from <code>.env</code> on the server. Edit .env and restart to change.</span>
            </div>
            <div class="grid-2">
              <div class="form-group">
                <label class="form-label">SMTP Host</label>
                <input class="form-input" value="smtp.gmail.com" readonly>
                <p class="form-hint">// SMTP_HOST in .env</p>
              </div>
              <div class="form-group">
                <label class="form-label">SMTP Port</label>
                <input class="form-input" value="587" readonly>
                <p class="form-hint">// 587=STARTTLS, 465=SSL</p>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">From Email</label>
              <input class="form-input" value="outreach@agentiq.app" readonly>
            </div>
            <button class="btn btn-secondary btn-sm" onclick="testSMTP()">ğŸ§ª Send Test Email</button>
          </div>
        </div>

        <!-- AI Config -->
        <div class="card" style="margin-bottom:16px">
          <div class="card-header"><div class="card-title">ğŸ¤– AI / Groq Configuration</div></div>
          <div class="card-body">
            <div class="form-group">
              <label class="form-label">API Provider</label>
              <input class="form-input" value="groq" readonly>
              <p class="form-hint">// API_PROVIDER in .env</p>
            </div>
            <div class="form-group">
              <label class="form-label">Model</label>
              <input class="form-input" value="llama-3.3-70b-versatile" readonly>
            </div>
            <div class="form-group">
              <label class="form-label">API Key</label>
              <input class="form-input" value="gsk_â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" readonly>
              <p class="form-hint">// GROQ_API_KEY â€” never displayed in full</p>
            </div>
          </div>
        </div>
      </div>

      <div>
        <!-- API Keys -->
        <div class="card" style="margin-bottom:16px">
          <div class="card-header">
            <div class="card-title">ğŸ”‘ API Keys</div>
            <button class="btn btn-primary btn-sm" onclick="showToast('POST /api-keys to generate', 'info')">+ Generate</button>
          </div>
          <div class="card-body">
            <div style="padding:10px 0;border-bottom:1px solid var(--border)">
              <div class="flex-between">
                <span style="font-size:13px;font-weight:600">Production Key</span>
                <span class="badge badge-converted">active</span>
              </div>
              <p class="text-mono text-muted mt4">aiq_sk_Abc123... Â· Last used 2h ago</p>
            </div>
            <div style="padding:10px 0">
              <div class="flex-between">
                <span style="font-size:13px;font-weight:600">Dev Key</span>
                <span class="badge badge-dead">inactive</span>
              </div>
              <p class="text-mono text-muted mt4">aiq_sk_Xyz789... Â· Never used</p>
            </div>
          </div>
        </div>

        <!-- .env Quickref -->
        <div class="card">
          <div class="card-header"><div class="card-title">ğŸ“„ .env Quick Reference</div></div>
          <div class="card-body">
            <div class="code-snippet">
<span class="c"># AI</span>
<span class="k">GROQ_API_KEY</span>=<span class="v">gsk_...</span>
<span class="k">GROQ_MODEL</span>=<span class="v">llama-3.3-70b-versatile</span>

<span class="c"># Database (Neon)</span>
<span class="k">DATABASE_URL</span>=<span class="v">postgresql+asyncpg://...</span>

<span class="c"># Auth</span>
<span class="k">SECRET_KEY</span>=<span class="v">64-char-hex-string</span>

<span class="c"># SMTP</span>
<span class="k">SMTP_HOST</span>=<span class="v">smtp.gmail.com</span>
<span class="k">SMTP_PASSWORD</span>=<span class="v">app-password-here</span>

<span class="c"># Redis (Upstash)</span>
<span class="k">REDIS_URL</span>=<span class="v">redis://default:xxx@host:6379</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div><!-- /settings -->

  <!-- â•â•â•â•â•â•â•â•â•â• ADMIN PAGE â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-admin">
    <div class="alert alert-warning">
      <span>ğŸ”‘</span>
      <span>Admin access only. Routes protected by <code>require_admin</code> dependency. Set is_admin=true in DB.</span>
    </div>

    <div class="stats-grid">
      <div class="stat-card stat-blue">
        <div class="stat-label">Organizations</div>
        <div class="stat-value">14</div>
      </div>
      <div class="stat-card stat-accent">
        <div class="stat-label">Total Users</div>
        <div class="stat-value">38</div>
      </div>
      <div class="stat-card stat-green">
        <div class="stat-label">All Leads</div>
        <div class="stat-value">12,441</div>
      </div>
      <div class="stat-card stat-purple">
        <div class="stat-label">Platform Credits</div>
        <div class="stat-value">84,210</div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <div class="card-title">All Users Â· GET /admin/users</div>
        <span class="text-mono text-muted">is_admin required</span>
      </div>
      <table class="data-table">
        <thead>
          <tr><th>Name</th><th>Email</th><th>Role</th><th>Org</th><th>Created</th><th>Last Login</th></tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Jane Smith</strong></td>
            <td class="text-mono"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7b1a1f1612153b1a1c1e150f120a551a0b0b">[email&#160;protected]</a></td>
            <td><span class="badge badge-admin">admin</span></td>
            <td>AgentIQ</td>
            <td class="text-mono text-muted">2024-01-01</td>
            <td class="text-mono text-muted">2h ago</td>
          </tr>
          <tr>
            <td><strong>Bob Lee</strong></td>
            <td class="text-mono"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d3b1bcb193b2b0beb6fdb0bcbe">[email&#160;protected]</a></td>
            <td><span class="badge badge-new">user</span></td>
            <td>Acme Corp</td>
            <td class="text-mono text-muted">2024-01-10</td>
            <td class="text-mono text-muted">3d ago</td>
          </tr>
          <tr>
            <td><strong>Sarah Khan</strong></td>
            <td class="text-mono"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5c2f3d2e3d341c3e39283d723533">[email&#160;protected]</a></td>
            <td><span class="badge badge-new">user</span></td>
            <td>Beta Inc</td>
            <td class="text-mono text-muted">2024-01-14</td>
            <td class="text-mono text-muted">1d ago</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div><!-- /admin -->

  </div><!-- /.content -->
</div><!-- /.main -->

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- MODALS -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<!-- New Lead Modal -->
<div class="modal-overlay" id="modal-new-lead">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title">Add New Lead</div>
      <span class="modal-close" onclick="closeModal('modal-new-lead')">Ã—</span>
    </div>
    <div class="modal-body">
      <div class="grid-2">
        <div class="form-group">
          <label class="form-label">Company Name *</label>
          <input class="form-input" id="nl-company" placeholder="Acme Corp">
        </div>
        <div class="form-group">
          <label class="form-label">Contact Name</label>
          <input class="form-input" id="nl-contact" placeholder="Jane Smith">
        </div>
      </div>
      <div class="grid-2">
        <div class="form-group">
          <label class="form-label">Email</label>
          <input class="form-input" id="nl-email" type="email" placeholder="jane@company.com">
        </div>
        <div class="form-group">
          <label class="form-label">Phone</label>
          <input class="form-input" id="nl-phone" placeholder="+1 555 0100">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Website</label>
        <input class="form-input" id="nl-website" placeholder="https://company.com">
      </div>
      <div class="grid-2">
        <div class="form-group">
          <label class="form-label">Industry</label>
          <input class="form-input" id="nl-industry" placeholder="B2B SaaS">
        </div>
        <div class="form-group">
          <label class="form-label">Status</label>
          <select class="form-select" id="nl-status">
            <option value="new">New</option>
            <option value="contacted">Contacted</option>
            <option value="replied">Replied</option>
            <option value="converted">Converted</option>
          </select>
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Notes</label>
        <textarea class="form-textarea" id="nl-notes" placeholder="Add any notes about this lead..."></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeModal('modal-new-lead')">Cancel</button>
      <button class="btn btn-secondary" onclick="saveLead(); showToast('Lead saved! Running AI enrichment...','success')">Save Only</button>
      <button class="btn btn-primary" onclick="saveLead(); closeModal('modal-new-lead'); showToast('Lead saved + AI enrichment queued','success')">Save + AI Enrich</button>
    </div>
  </div>
</div>

<!-- Import CSV Modal -->
<div class="modal-overlay" id="modal-import-csv">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title">Import Leads from CSV</div>
      <span class="modal-close" onclick="closeModal('modal-import-csv')">Ã—</span>
    </div>
    <div class="modal-body">
      <div class="alert alert-info">
        <span>â„¹ï¸</span>
        <div>
          <strong>Auto-detected columns:</strong> company, company_name, email, name, contact, phone, website, industry, linkedin, notes, headquarters, employees<br>
          <span style="color:var(--text3);font-size:11px">Duplicates by email are updated, not duplicated. UTF-8 and latin-1 both supported.</span>
        </div>
      </div>
      <div style="border:2px dashed var(--border2);border-radius:var(--radius);padding:40px;text-align:center;cursor:pointer;background:var(--surface2)" onclick="document.getElementById('csv-file').click()">
        <div style="font-size:32px;margin-bottom:8px">ğŸ“</div>
        <div style="font-size:14px;font-weight:600;margin-bottom:4px">Drop CSV here or click to browse</div>
        <div style="font-size:12px;color:var(--text3)">POST /leads/import Â· max 10MB Â· UTF-8 recommended</div>
        <input type="file" id="csv-file" accept=".csv" style="display:none" onchange="handleCSVSelect(this)">
      </div>
      <div id="csv-preview" style="display:none;margin-top:16px">
        <div class="alert alert-success">
          <span>âœ…</span>
          <span id="csv-preview-msg">Ready to import</span>
        </div>
      </div>

      <div class="mt16">
        <p class="form-label">Sample CSV format:</p>
        <div class="code-snippet">
company,email,contact name,phone,website,industry
Stripe,<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="016b606f64417275736871642f626e6c">[email&#160;protected]</a>,Jane Smith,+1 415 000 0001,https://stripe.com,Fintech
Notion,<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="fe9c919cbe90918a979190d08d91">[email&#160;protected]</a>,Bob Lee,,https://notion.so,Productivity
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeModal('modal-import-csv')">Cancel</button>
      <button class="btn btn-primary" onclick="importCSV()">Import Now</button>
    </div>
  </div>
</div>

<!-- New Campaign Modal -->
<div class="modal-overlay" id="modal-new-campaign">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title">Create New Campaign</div>
      <span class="modal-close" onclick="closeModal('modal-new-campaign')">Ã—</span>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label class="form-label">Campaign Name *</label>
        <input class="form-input" placeholder="Q4 SaaS Outreach">
      </div>
      <div class="form-group">
        <label class="form-label">Subject Line *</label>
        <input class="form-input" placeholder="Hey {{first_name}}, quick question about {{company}}">
        <p class="form-hint">// supports: &#123;&#123;first_name&#125;&#125; &#123;&#123;company&#125;&#125; &#123;&#123;industry&#125;&#125; &#123;&#123;website&#125;&#125;</p>
      </div>
      <div class="form-group">
        <label class="form-label">Email Body (HTML supported) *</label>
        <textarea class="form-textarea" style="min-height:140px" placeholder="Hi {{first_name}},

I noticed {{company}} is in the {{industry}} space...

Best,
[Your Name]"></textarea>
      </div>
      <div class="grid-2">
        <div class="form-group">
          <label class="form-label">From Name</label>
          <input class="form-input" placeholder="Jane at AgentIQ" value="Sales Team">
        </div>
        <div class="form-group">
          <label class="form-label">Reply To</label>
          <input class="form-input" placeholder="sales@company.com">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Send Rate (emails/min)</label>
        <input class="form-input" type="number" value="20" min="1" max="300">
        <p class="form-hint">// Default 20/min. Gmail free: max 500/day total.</p>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeModal('modal-new-campaign')">Cancel</button>
      <button class="btn btn-secondary" onclick="closeModal('modal-new-campaign'); showToast('Campaign saved as draft','success')">Save Draft</button>
      <button class="btn btn-primary" onclick="closeModal('modal-new-campaign'); showToast('Campaign created â€” add leads then send','success')">Create Campaign</button>
    </div>
  </div>
</div>

<!-- Email Preview Modal -->
<div class="modal-overlay" id="modal-preview-email">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title">Email Preview Â· GET /campaigns/{id}/preview</div>
      <span class="modal-close" onclick="closeModal('modal-preview-email')">Ã—</span>
    </div>
    <div class="modal-body">
      <div class="alert alert-info" style="margin-bottom:14px">
        <span>â„¹ï¸</span>
        <span>Rendered with sample data. Use ?lead_id=... to preview with a real lead's fields.</span>
      </div>
      <div style="border:1px solid var(--border);border-radius:var(--radius);overflow:hidden">
        <div style="background:var(--surface2);padding:10px 14px;border-bottom:1px solid var(--border);font-size:12px">
          <strong>Subject:</strong> Hey Jane, quick question about Acme Corp<br>
          <strong>From:</strong> Sales Team &lt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d4bba1a0a6b1b5b7bc94b5b3b1baa0bda5fab5a4a4">[email&#160;protected]</a>&gt;<br>
          <strong>To:</strong> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f99398979cb9989a949c9a968b89d79a9694">[email&#160;protected]</a>
        </div>
        <div style="padding:20px;font-size:13px;line-height:1.7">
          <p>Hi Jane,</p>
          <br>
          <p>I noticed Acme Corp is in the B2B SaaS space, and we've been helping similar companies accelerate their outreach by 3x using AI-powered lead enrichment.</p>
          <br>
          <p>Would you have 15 minutes this week to see how it could work for your team?</p>
          <br>
          <p>Best,<br>Sales Team</p>
        </div>
      </div>
      <p class="text-mono text-muted mt8" style="font-size:11px">Variables used: first_name=Jane, company=Acme Corp, industry=B2B SaaS</p>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeModal('modal-preview-email')">Close</button>
      <button class="btn btn-secondary" onclick="testSMTP()">ğŸ§ª Send Test to Me</button>
    </div>
  </div>
</div>

<!-- New Job Modal -->
<div class="modal-overlay" id="modal-new-job">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title">New Enrichment Job Â· POST /jobs</div>
      <span class="modal-close" onclick="closeModal('modal-new-job')">Ã—</span>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label class="form-label">Job Name</label>
        <input class="form-input" placeholder="Q4 Batch Enrich" value="New Batch">
      </div>
      <div class="form-group">
        <label class="form-label">Companies (one per line) *</label>
        <textarea class="form-textarea" style="min-height:120px" placeholder="Stripe&#10;Notion&#10;Linear&#10;Figma"></textarea>
        <p class="form-hint">// Or upload CSV with company column. Max 500 per job on free plan.</p>
      </div>
      <div class="alert alert-info">
        <span>â„¹ï¸</span>
        <span>Job will run in background via Celery. Each company takes ~20-60s. 500 companies â‰ˆ ~3 hours.</span>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeModal('modal-new-job')">Cancel</button>
      <button class="btn btn-primary" onclick="closeModal('modal-new-job'); showToast('Job queued â€” check Enrichment Jobs tab','success')">Start Job</button>
    </div>
  </div>
</div>

<!-- Toast -->
<div class="toast" id="toast">
  <span id="toast-icon">âœ“</span>
  <span id="toast-msg">Done</span>
</div>


<script>
// â”€â”€ API Configuration â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const API_BASE = 'https://agentiq-production.up.railway.app';
let authToken = null;

// â”€â”€ Fallback demo data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const DEMO_LEADS = [
  { id:'1', company_name:"Stripe", contact_name:"Jane Smith", email:"jane@stripe.com", industry:"Fintech", status:"new", score:92, source:"ai_enriched" },
  { id:'2', company_name:"Notion Labs", contact_name:"Bob Lee", email:"bob@notion.so", industry:"Productivity", status:"contacted", score:78, source:"csv_import" },
  { id:'3', company_name:"Figma", contact_name:"Marc D", email:"marc@figma.com", industry:"Design", status:"replied", score:90, source:"ai_enriched" },
];

// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let currentUser = null;
let currentLeads = [];

// â”€â”€ Auth â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function doLogin() {
  const email = document.getElementById('login-email').value.trim();
  const pass  = document.getElementById('login-password').value;

  if (!email || !pass) {
    document.getElementById('login-error-msg').textContent = 'Email and password are required.';
    document.getElementById('login-error').style.display = 'flex';
    return;
  }

  try {
    showToast('Logging in...', 'info');
    const res = await fetch(`${API_BASE}/auth/login`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      body: `username=${encodeURIComponent(email)}&password=${encodeURIComponent(pass)}`
    });

    if (!res.ok) {
      document.getElementById('login-error-msg').textContent = 'Wrong email or password.';
      document.getElementById('login-error').style.display = 'flex';
      return;
    }

    const data = await res.json();
    authToken = data.access_token;
    currentUser = { email, name: email.split('@')[0], role: 'admin' };
    document.getElementById('login-screen').classList.remove('show');
    document.getElementById('user-name').textContent = currentUser.name;
    document.getElementById('user-role').textContent = currentUser.role;
    document.getElementById('user-avatar').textContent = currentUser.name[0].toUpperCase();
    document.getElementById('login-error').style.display = 'none';
    await loadLeads();
    showToast('Welcome back, ' + currentUser.name + '!', 'success');

  } catch (err) {
    document.getElementById('login-error-msg').textContent = 'Cannot connect to server.';
    document.getElementById('login-error').style.display = 'flex';
  }
}

function doLogout() {
  authToken = null;
  currentUser = null;
  document.getElementById('login-screen').classList.add('show');
}

function togglePassword() {
  const input = document.getElementById('login-password');
  input.type = input.type === 'password' ? 'text' : 'password';
}

document.getElementById('login-password').addEventListener('keydown', e => {
  if (e.key === 'Enter') doLogin();
});

// â”€â”€ Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PAGE_TITLES = {
  dashboard:  ['Dashboard',        '// Overview & metrics'],
  leads:      ['Leads',            '// CRM lead database'],
  pipeline:   ['Pipeline',         '// Kanban status view'],
  campaigns:  ['Campaigns',        '// Email outreach'],
  enrichment: ['Enrichment Jobs',  '// AI batch processing'],
  logs:       ['Logs & Metrics',   '// System monitoring'],
  settings:   ['Settings',         '// Configuration'],
  admin:      ['Admin',            '// Platform stats'],
};

function showPage(id, navEl) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.getElementById('page-' + id).classList.add('active');
  if (navEl) navEl.classList.add('active');
  const [title, sub] = PAGE_TITLES[id] || ['AgentIQ', ''];
  document.getElementById('topbar-title').textContent = title;
  document.getElementById('topbar-sub').textContent = sub;
}

// â”€â”€ Leads API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadLeads() {
  try {
    const res = await fetch(`${API_BASE}/leads?limit=100`, {
      headers: { 'Authorization': `Bearer ${authToken}` }
    });
    if (!res.ok) { currentLeads = [...DEMO_LEADS]; renderLeads(currentLeads); return; }
    const data = await res.json();
    currentLeads = data.leads || data.items || data || [];
    if (currentLeads.length === 0) currentLeads = [...DEMO_LEADS];
    renderLeads(currentLeads);
  } catch (err) {
    currentLeads = [...DEMO_LEADS];
    renderLeads(currentLeads);
  }
}

async function saveLead() {
  const company_name = document.getElementById('nl-company').value.trim();
  if (!company_name) { showToast('Company name is required', 'error'); return; }

  try {
    showToast('Saving lead...', 'info');
    const res = await fetch(`${API_BASE}/leads`, {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${authToken}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        company_name,
        contact_name: document.getElementById('nl-contact').value || null,
        email: document.getElementById('nl-email').value || null,
        industry: document.getElementById('nl-industry').value || null,
        source: 'manual'
      })
    });

    if (res.ok) {
      showToast('Lead saved!', 'success');
      closeModal('modal-new-lead');
      await loadLeads();
    } else {
      const err = await res.json();
      showToast('Error: ' + (err.detail || 'Save failed'), 'error');
    }
  } catch (err) {
    showToast('Cannot connect to server', 'error');
  }
}

async function updateStatus(id, status) {
  if (!status) return;
  try {
    await fetch(`${API_BASE}/leads/${id}`, {
      method: 'PATCH',
      headers: {
        'Authorization': `Bearer ${authToken}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ status })
    });
    showToast(`Lead moved to "${status}"`, 'success');
    await loadLeads();
  } catch (err) {
    showToast('Update failed', 'error');
  }
}

async function enrichLead(id) {
  showToast('AI enrichment started â€” takes 20-60s...', 'info');
  try {
    await fetch(`${API_BASE}/leads/${id}/enrich`, {
      method: 'POST',
      headers: { 'Authorization': `Bearer ${authToken}` }
    });
    showToast('Enrichment queued! Reloading in 30s...', 'success');
    setTimeout(loadLeads, 30000);
  } catch (err) {
    showToast('Enrichment failed', 'error');
  }
}

async function deleteLead(id) {
  if (!confirm('Delete this lead?')) return;
  try {
    await fetch(`${API_BASE}/leads/${id}`, {
      method: 'DELETE',
      headers: { 'Authorization': `Bearer ${authToken}` }
    });
    showToast('Lead deleted', 'success');
    await loadLeads();
  } catch (err) {
    showToast('Delete failed', 'error');
  }
}

// â”€â”€ Leads Table â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function statusBadge(s) {
  const cls = { new:'badge-new', contacted:'badge-contacted', replied:'badge-replied', converted:'badge-converted', dead:'badge-dead' }[s] || 'badge-new';
  return `<span class="badge ${cls}">${s}</span>`;
}

function scoreColor(n) {
  if (n >= 80) return 'var(--green)';
  if (n >= 50) return 'var(--yellow)';
  return 'var(--accent)';
}

function renderLeads(leads) {
  const tbody = document.getElementById('leads-tbody');
  if (!leads.length) {
    tbody.innerHTML = '<tr><td colspan="9"><div class="empty-state"><div class="empty-icon">ğŸ‘¥</div><div class="empty-title">No leads yet</div><div class="empty-sub">Import a CSV or add manually</div></div></td></tr>';
    return;
  }
  tbody.innerHTML = leads.map(l => `
    <tr>
      <td><input type="checkbox"></td>
      <td><strong>${l.company_name || l.company || ''}</strong></td>
      <td>${l.contact_name || l.contact || 'â€”'}</td>
      <td class="text-mono">${l.email || 'â€”'}</td>
      <td>${l.industry || 'â€”'}</td>
      <td>${statusBadge(l.status || 'new')}</td>
      <td><span style="color:${scoreColor(l.score || l.confidence_score || 50)};font-weight:700">${l.score || l.confidence_score || 'â€”'}</span></td>
      <td class="text-mono text-muted">${l.source || 'manual'}</td>
      <td>
        <button class="btn btn-ghost btn-sm" onclick="enrichLead('${l.id}')">ğŸ¤– Enrich</button>
        <select class="filter-select" style="font-size:11px;padding:4px 6px" onchange="updateStatus('${l.id}', this.value)">
          <option value="">Move to...</option>
          <option value="new">New</option>
          <option value="contacted">Contacted</option>
          <option value="replied">Replied</option>
          <option value="converted">Converted</option>
          <option value="dead">Dead</option>
        </select>
      </td>
    </tr>
  `).join('');
  if (document.getElementById('badge-leads'))
    document.getElementById('badge-leads').textContent = leads.length;
}

function filterLeads(q) {
  const filtered = currentLeads.filter(l =>
    (l.company_name || '').toLowerCase().includes(q.toLowerCase()) ||
    (l.email || '').toLowerCase().includes(q.toLowerCase())
  );
  renderLeads(filtered);
}

function filterLeadsByStatus(status) {
  renderLeads(status ? currentLeads.filter(l => l.status === status) : [...currentLeads]);
}

function selectAll(cb) {
  document.querySelectorAll('#leads-tbody input[type=checkbox]').forEach(c => c.checked = cb.checked);
}

async function exportCSV() {
  try {
    const res = await fetch(`${API_BASE}/leads/export/csv`, {
      headers: { 'Authorization': `Bearer ${authToken}` }
    });
    const blob = await res.blob();
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'leads.csv'; a.click();
    showToast('CSV downloaded!', 'success');
  } catch (err) {
    showToast('Export failed', 'error');
  }
}

// â”€â”€ CSV Import â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function handleCSVSelect(input) {
  if (input.files.length) {
    document.getElementById('csv-preview-msg').textContent =
      `${input.files[0].name} selected (${Math.round(input.files[0].size/1024)}KB) â€” ready to import`;
    document.getElementById('csv-preview').style.display = 'block';
  }
}

async function importCSV() {
  const fileInput = document.querySelector('input[type="file"]');
  if (!fileInput || !fileInput.files.length) {
    showToast('Please select a CSV file first', 'error');
    return;
  }
  closeModal('modal-import-csv');
  showToast('Importing CSV...', 'info');
  try {
    const formData = new FormData();
    formData.append('file', fileInput.files[0]);
    const res = await fetch(`${API_BASE}/leads/import/csv`, {
      method: 'POST',
      headers: { 'Authorization': `Bearer ${authToken}` },
      body: formData
    });
    const data = await res.json();
    showToast(`Import done! Created: ${data.created || 0}, Updated: ${data.updated || 0}`, 'success');
    await loadLeads();
  } catch (err) {
    showToast('Import failed', 'error');
  }
}

// â”€â”€ Campaigns â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function sendCampaign() {
  showToast('Campaign started! Emails queued.', 'success');
}

// â”€â”€ System â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function checkHealth() {
  try {
    const res = await fetch(`${API_BASE}/health`);
    const data = await res.json();
    showToast(`Status: ${data.status} | DB: âœ“ | AI: ${data.ai_key} | SMTP: ${data.smtp}`, 'success');
  } catch (err) {
    showToast('Cannot reach server', 'error');
  }
}

async function testSMTP() {
  try {
    const res = await fetch(`${API_BASE}/email/test`, {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${authToken}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ to_email: currentUser?.email || 'test@test.com' })
    });
    if (res.ok) {
      showToast('Test email sent! Check your inbox.', 'success');
    } else {
      showToast('SMTP test failed', 'error');
    }
  } catch (err) {
    showToast('Cannot connect to server', 'error');
  }
}

async function filterLogs(type) {
  showToast(`Filtering logs: ${type || 'all'}`, 'info');
}

// â”€â”€ Modals â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openModal(id) {
  document.getElementById(id).classList.add('open');
}

function closeModal(id) {
  document.getElementById(id).classList.remove('open');
}

document.querySelectorAll('.modal-overlay').forEach(overlay => {
  overlay.addEventListener('click', e => {
    if (e.target === overlay) overlay.classList.remove('open');
  });
});

// â”€â”€ Toast â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let toastTimer;
function showToast(msg, type = 'info') {
  const el = document.getElementById('toast');
  const icon = { success:'âœ“', error:'âœ—', info:'â„¹', warn:'âš ' }[type] || 'â„¹';
  const cls  = { success:'toast-success', error:'toast-error', info:'', warn:'' }[type] || '';
  document.getElementById('toast-icon').textContent = icon;
  document.getElementById('toast-msg').textContent = msg;
  el.className = 'toast show ' + cls;
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => el.classList.remove('show'), 3500);
}
</script>
</body>
</html>
